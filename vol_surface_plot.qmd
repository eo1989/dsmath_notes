---
jupyter:
  jupytext:
    text_representation:
      extension: .qmd
      format_name: quarto
      format_version: '1.0'
      jupytext_version: 1.18.1
  kernelspec:
    display_name: Gen
    language: python
    name: python3
---

```{python}
import dotenv
import quantflow.options as qf_opts
from quantflow.data import fmp

# from volvisdata import volatility
from volvisualizer import volatility
import pandas as pd

keys = dotenv.load_dotenv(dotenv_path="/Users/eo/Dev/.env")
import os
```

```{python}
from quantflow.data.fmp import FMP
from quantflow.utils import plot, distributions, transforms
```

```{python}
print(dotenv.get_key("../.env", "FINANCIAL_MODELING_PREP_KEY"))
FMP_key = dotenv.get_key("../.env", "FINANCIAL_MODELING_PREP_KEY")
# os.getenv(dotenv.get_cli_string("../.env", key="FMP"))
```

Symbol Limited to: 
AAPL, TSLA, AMZN, MSFT, NVDA, GOOGL, META, NFLX, JPM, V, BAC, AMD, PYPL, DIS, T, PFE, COST, INTC, KO, TGT, NKE, SPY, BA, BABA, XOM, WMT, GE, CSCO, VZ, JNJ, CVX, PLTR, SQ, SHOP, SBUX, SOFI, HOOD, RBLX, SNAP, AMD, UBER, FDX, ABBV, ETSY, MRNA, LMT, GM, F, RIVN, LCID, CCL, DAL, UAL, AAL, TSM, SONY, ET, NOK, MRO, COIN, RIVN, SIRI, SOFI, RIOT, CPRX, PYPL, TGT, VWO, SPYG, NOK, ROKU, HOOD, VIAC, ATVI, BIDU, DOCU, ZM, PINS, TLRY, WBA, VIAC, MGM, NFLX, NIO, C, GS, WFC, ADBE, PEP, UNH, CARR, FUBO, HCA, TWTR, BILI, SIRI, VIAC, FUBO, RKT

```{python}
# tickers = ["OKLO", "AAPL", "LEU", "AMZN", "NKTR"]
tickers = [
    "AAPL",
    "TSLA",
    "AMZN",
    "MSFT",
    "NVDA",
    "GOOGL",
    "META",
    "NFLX",
    "JPM",
    "V",
    "BAC",
    "AMD",
    "PYPL",
    "DIS",
    "T",
    "PFE",
    "COST",
    "INTC",
    "KO",
    "TGT",
    "NKE",
    "SPY",
    "BA",
    "BABA",
    "XOM",
    "WMT",
    "GE",
    "CSCO",
    "VZ",
    "JNJ",
    "CVX",
    "PLTR",
    "SQ",
    "SHOP",
    "SBUX",
    "SOFI",
    "HOOD",
    "RBLX",
    "SNAP",
    "AMD",
    "UBER",
    "FDX",
    "ABBV",
    "ETSY",
    "MRNA",
    "LMT",
    "GM",
    "F",
    "RIVN",
    "LCID",
    "CCL",
    "DAL",
    "UAL",
    "AAL",
    "TSM",
    "SONY",
    "ET",
    "NOK",
    "MRO",
    "COIN",
    "RIVN",
    "SIRI",
    "SOFI",
    "RIOT",
    "CPRX",
    "PYPL",
    "TGT",
    "VWO",
    "SPYG",
    "NOK",
    "ROKU",
    "HOOD",
    "VIAC",
    "ATVI",
    "BIDU",
    "DOCU",
    "ZM",
    "PINS",
    "TLRY",
    "WBA",
    "VIAC",
    "MGM",
    "NFLX",
    "NIO",
    "C",
    "GS",
    "WFC",
    "ADBE",
    "PEP",
    "UNH",
    "CARR",
    "FUBO",
    "HCA",
    "TWTR",
    "BILI",
    "SIRI",
    "VIAC",
    "FUBO",
    "RKT",
]


def grab_tickers():
    # for ticker in tickers:
    return tickers


cli = FMP(key=FMP_key)
```

```{python}
prices = await cli.prices("RKT", frequency="")
```

```{python}
plot.candlestick_plot(prices).update_layout(height=500)
```

```{python}
prices
```

```{python}
df_backup = prices.copy()

df = prices.drop(columns=["symbol", "vwap"])
df_rkt = df.copy()
df_rkt
```

```{python}
from quantflow.ta.ohlc import OHLC

# df = OHLC(serie=prices, rogers_satchell_variance=True, parkinson_variance=True)
df_rkt_close = OHLC(df_rkt)
df_rkt_close
```

```{python}
async with FMP(key=FMP_key) as cli:
    for v in tickers:
        print(v)
    loader = await cli.quote(v)
```

