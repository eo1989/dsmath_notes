---
jupyter:
  jupytext:
    text_representation:
      extension: .md
      format_name: markdown
      format_version: '1.3'
      jupytext_version: 1.17.2
  kernelspec:
    display_name: Gen
    language: python
    name: python3
---

# Parametric Tests

```python
import math as mt
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
import statsmodels.api as smi
import pandas as pd
from scipy.stats import skewnorm
from scipy.stats import t
```

```python
# styledict = {
#     'xtick.labelsize': 21,
#     'xtick.major.size': 9,
#     'xtick.major.width': 1,
#     'ytick.labelsize': 21,
#     'ytick.major.size': 9,
#     'ytick.major.width': 1,
#     'legend.framealpha': 0.0,
#     'legend.fontsize': 15,
#     'axes.labelsize': 22,
#     'axes.titlesize': 22,
#     'axes.linewidth': 2,
#     'figure.figsize': (12, 8),
#     'savefig.format': 'jpg'
# }
# plt.rcParams.update(**styledict)
```

```python
# x = t.rvs(df = 8, size = 100_000)
# data = pd.DataFrame({'x': x})
# data.to_csv('./data/SkewNormData.csv', index = False)

# x = t.rvs(df = 80, size = 100_000)
# data2 = pd.DataFrame({'x': x})
# data2.to_csv('./data/SkewNormData2.csv', index = False)
```

```python
data = pd.read_csv("./data/skewnormdata.csv")
data2 = pd.read_csv("./data/skewnormdata.csv")

```

### Degrees of Freedom

```python
fig, ax = plt.subplots(1, 2, figsize=(10, 5))
ax[0].set_title("Without Degrees of Freedom")
ax[1].set_title("With Degrees of Freedom")

sns.kdeplot(data=data, x="x", fill=True, ax=ax[0], bw_adjust=10)
sns.kdeplot(data=data2, x="x", fill=True, ax=ax[1], bw_adjust=10)

ax[0].set_xticks([])
ax[1].set_xticks([])

ax[0].axvline(data["x"].median(), color="brown", ymin=0, ymax=0.94)
ax[0].annotate(
    "Median = 1.6",
    xy=(data["x"].median(), 0.078),
    xytext=(data["x"].median() + 2.8, 0.075),
    arrowprops=dict(arrowstyle="->", facecolor="black"),
    fontsize=14,
)

ax[0].axvline(0.9, color="blue", ymin=0, ymax=0.8)
ax[0].annotate(
    "Mean = 1.8",
    xy = (1, 0.058),
    xytext = (3.5, 0.055),
    arrowprops = dict(arrowstyle = '->', facecolor = 'black'),
    fontsize = 14
)

ax[1].axvline(data2["x"].median(), color="brown", ymin=0, ymax=0.94)
ax[1].annotate(
    "Median = 1.6",
    xy=(data2["x"].median(), 0.088),
    xytext=(data2["x"].median() + 2.4, 0.085),
    arrowprops=dict(arrowstyle="->", facecolor="black"),
    fontsize=14,
)

ax[1].axvline(0.5, color="blue", ymin=0, ymax=0.89)
ax[1].annotate(
    "Mean = 1.8",
    xy = (0.6, 0.068),
    xytext = (data2['x'].median() + 2.8, 0.065),
    arrowprops = dict(arrowstyle = '->', facecolor = 'black'),
    fontsize = 14
)

```

### Variance Assumption

```python
from scipy.stats import levene

rng = np.random.default_rng(42)

mu1, sigma1 = 0, 0.9
mu2, sigma2 = 0, 1.1
mu3, sigma3 = 0, 2

distro1 = pd.DataFrame()
distro1['x'] = rng.normal(mu1, sigma1, 100)

distro2 = pd.DataFrame()
distro2['x'] = rng.normal(mu2, sigma2, 100)

distro3 = pd.DataFrame()
distro3['x'] = rng.normal(mu3, sigma3, 100)


fig, ax = plt.subplots(1, 3, figsize = (15, 5))

ax[0].set_title('Distribution A')
ax[1].set_title('Distribution B')
ax[2].set_title('Distribution C')


sns.kdeplot(data = distro1, x = 'x', fill=True, ax = ax[0], bw_adjust=10)
sns.kdeplot(data = distro2, x = 'x', fill=True, ax = ax[1], bw_adjust=10)
sns.kdeplot(data = distro3, x = 'x', fill=True, ax = ax[2], bw_adjust=10)

f_stat, p_val = levene(distro1['x'], distro2['x'], distro3['x'])
if p_val <= 0.05:
    print(f"The distributions dont have homogenous variance. P-Value: {p_val:.4g}, F-statistic: {f_stat:.4f}")
else:
    print(f"The distributions have homogenous variance. P-value: {p_val:.4g}, F-statistic: {f_stat:.4f}")
# plt.savefig('./Non-constantVar.png', dpi = 300, facecolor = 'w', bbox_inches = 'tight')

```

```python
rng = np.random.default_rng(26)
mu1, sigma1 = 0, 0.9
mu2, sigma2 = 0, 1.1
mu3, sigma3 = 0, 270

distro1 = pd.DataFrame()
distro1['x'] = rng.normal(mu1, sigma1, 100)

distro2 = pd.DataFrame()
distro2['x'] = rng.normal(mu2, sigma2, 100)

distro3 = pd.DataFrame()
distro3['x'] = rng.normal(mu3, sigma3, 100)

from scipy.stats import f

def ftest(inputA, inputB):

    group1 = np.array(inputA)
    group2 = np.array(inputB)

    if np.var(group1) > np.var(group2):
        f_statistic = np.var(group1) / np.var(group2)

        numeratorDegFreedom = group1.shape[0] - 1
        denominatorDegFreedom = group2.shape[0] - 1
    else:
        f_statistic = np.var(group2) / np.var(group1)

        numeratorDegFreedom = group2.shape[0] - 1
        denominatorDegFreedom = group1.shape[0] - 1

    p_value = 1 - f.cdf(f_statistic, numeratorDegFreedom, denominatorDegFreedom)

    if p_value <= 0.05:
        print(f"The distributions do not have homogenous variance. P-Value: {p_value:.4g}, F-statistic: {f_statistic:.4f}")
    else:
        print(f"The distributions have homogenous variance. P-value: {p_value:.4g}, F-statistic: {f_statistic:.4f}")

ftest(distro3['x'], distro1['x'])

```

### Independence Assumption


```python
from statsmodels.stats.stattools import durbin_watson

mu, sigma = 0, 1.1
independent_samples = np.random.normal(mu, sigma, 1_000)
correlated_samples = np.linspace(-np.pi, np.pi, num=1_000)

fig, ax = plt.subplots(1, 2, figsize = (10, 5))

ax[0].plot(correlated_samples, np.sin(correlated_samples))
ax[0].set_title(f'Durbin Waton = {durbin_watson(correlated_samples):.7g}')

ax[1].plot(independent_samples)
ax[1].set_title(f'Durbin Waton = {durbin_watson(independent_samples):.7f}')
```

### Normality Assumption

```python
import scipy.stats as stats

mu, sigma = 0, 1.1
normally_distributed = np.random.normal(mu, sigma, 1000)

fig, ax = plt.subplots(2,2, figsize=(10,10))

ax[0,0].set_title('Exponentially Distributed Data')
ax[0,1].set_title('Normally Distributed Data')

ax[0,0].hist(np.exp(normally_distributed), bins=50)
ax[0,1].hist(normally_distributed, bins=50)

stats.probplot(np.exp(normally_distributed), dist="norm", plot=ax[1,0])
stats.probplot(normally_distributed, dist="norm", plot=ax[1,1])
```

```python
# plt.savefig('./QQPlots.png', dpi = 300, facecolor = 'w', bbox_inches = 'tight')
# plt.show()
```

```python
mu, sigma = 0, 0.1
normally_distributed = rng.normal(mu, sigma, 1_000)
```

### Kolmogorov-Smirnov

 - This test requires data to be centered at 0 with unit variance.

```python

```
